<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>종합 학업 성적 분석 보고서</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=Noto+Serif+KR:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 10pt;
            line-height: 1.6;
            color: #2c3e50;
            background: white;
        }
        
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 15mm 20mm;
            background: white;
            page-break-after: always;
            position: relative;
        }
        
        /* 공식 문서 헤더 */
        .official-header {
            border-bottom: 4px double #1a237e;
            padding-bottom: 15px;
            margin-bottom: 25px;
            position: relative;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .institution-info {
            flex: 1;
        }
        
        .institution-name {
            font-family: 'Noto Serif KR', serif;
            font-size: 16pt;
            font-weight: 700;
            color: #1a237e;
            margin-bottom: 5px;
        }
        
        .institution-details {
            font-size: 9pt;
            color: #5c6bc0;
            line-height: 1.4;
        }
        
        .document-info {
            text-align: right;
            font-size: 9pt;
        }
        
        .document-number {
            font-weight: 700;
            color: #1a237e;
            margin-bottom: 3px;
        }
        
        .document-date {
            color: #666;
        }
        
        .report-title {
            text-align: center;
            margin: 30px 0;
        }
        
        .report-title h1 {
            font-family: 'Noto Serif KR', serif;
            font-size: 22pt;
            font-weight: 700;
            color: #1a237e;
            margin-bottom: 8px;
            letter-spacing: 3px;
        }
        
        .report-subtitle {
            font-size: 12pt;
            color: #5c6bc0;
            font-weight: 500;
        }
        
        .report-subtitle-en {
            font-size: 10pt;
            color: #7986cb;
            font-style: italic;
            margin-top: 5px;
        }
        
        /* 학생 정보 카드 - 전문적 스타일 */
        .student-profile-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #e8eaf6 100%);
            border: 1px solid #c5cae9;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3f51b5;
        }
        
        .profile-photo {
            width: 80px;
            height: 100px;
            border: 2px solid #3f51b5;
            border-radius: 4px;
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9e9e9e;
            font-size: 9pt;
            margin-right: 20px;
        }
        
        .profile-details {
            flex: 1;
        }
        
        .profile-details table {
            width: 100%;
        }
        
        .profile-details td {
            padding: 4px 10px;
            font-size: 10pt;
        }
        
        .profile-label {
            font-weight: 600;
            color: #3f51b5;
            width: 100px;
        }
        
        .profile-value {
            color: #424242;
        }
        
        /* 섹션 스타일 */
        .section {
            margin: 30px 0;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .section-header {
            background: linear-gradient(90deg, #3f51b5 0%, #5c6bc0 100%);
            color: white;
            padding: 12px 20px;
            font-size: 13pt;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-icon {
            font-size: 16pt;
        }
        
        .section-content {
            padding: 20px;
        }
        
        /* 학업 성취도 테이블 */
        .achievement-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 15px 0;
        }
        
        .achievement-table thead {
            background: #e8eaf6;
        }
        
        .achievement-table th {
            padding: 10px;
            text-align: center;
            font-weight: 600;
            color: #3f51b5;
            border: 1px solid #c5cae9;
        }
        
        .achievement-table td {
            padding: 8px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }
        
        .achievement-table tbody tr:hover {
            background: #f5f5f5;
        }
        
        /* TOPIK 성적 카드 - 개선된 디자인 */
        .topik-results-card {
            background: white;
            border: 2px solid #3f51b5;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .topik-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .topik-title {
            font-size: 14pt;
            font-weight: 700;
            color: #1a237e;
            margin-bottom: 5px;
        }
        
        .topik-test-info {
            color: #666;
            font-size: 10pt;
        }
        
        .topik-scores {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .score-box {
            background: #f5f7fa;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }
        
        .score-label {
            font-size: 9pt;
            color: #666;
            margin-bottom: 5px;
        }
        
        .score-value {
            font-size: 24pt;
            font-weight: 700;
            color: #3f51b5;
        }
        
        .score-max {
            font-size: 10pt;
            color: #999;
        }
        
        .topik-total {
            background: linear-gradient(135deg, #3f51b5 0%, #5c6bc0 100%);
            color: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .topik-total-label {
            font-size: 11pt;
            margin-bottom: 5px;
        }
        
        .topik-total-score {
            font-size: 28pt;
            font-weight: 700;
        }
        
        .topik-level {
            display: inline-block;
            background: #ffd54f;
            color: #f57c00;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            margin-top: 10px;
        }
        
        /* 학습 진도 차트 */
        .progress-section {
            margin: 20px 0;
        }
        
        .progress-item {
            margin-bottom: 15px;
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .progress-label {
            font-weight: 600;
            color: #424242;
        }
        
        .progress-value {
            font-weight: 700;
            color: #3f51b5;
        }
        
        .progress-bar {
            height: 25px;
            background: #e0e0e0;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50 0%, #8bc34a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 9pt;
            transition: width 0.3s ease;
        }
        
        /* 상담 이력 타임라인 */
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #c5cae9;
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            padding-left: 15px;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -24px;
            top: 5px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #3f51b5;
            border: 2px solid white;
            box-shadow: 0 0 0 2px #c5cae9;
        }
        
        .timeline-date {
            font-weight: 600;
            color: #3f51b5;
            margin-bottom: 5px;
        }
        
        .timeline-content {
            background: #f5f7fa;
            border-radius: 6px;
            padding: 10px;
            border-left: 3px solid #3f51b5;
        }
        
        /* 평가 및 추천사 */
        .evaluation-section {
            background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%);
            border: 2px solid #fbc02d;
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
        }
        
        .evaluation-title {
            font-size: 14pt;
            font-weight: 700;
            color: #f57c00;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .evaluation-content {
            line-height: 1.8;
            text-align: justify;
            color: #424242;
        }
        
        .highlight-text {
            background: #ffeb3b;
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        /* 서명 섹션 */
        .signature-section {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }
        
        .signature-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-top: 40px;
        }
        
        .signature-box {
            text-align: center;
        }
        
        .signature-line {
            border-bottom: 1px solid #666;
            height: 40px;
            margin-bottom: 5px;
        }
        
        .signature-name {
            font-weight: 600;
            color: #424242;
            margin-bottom: 3px;
        }
        
        .signature-title {
            font-size: 9pt;
            color: #666;
        }
        
        /* 공식 직인 영역 */
        .official-stamp {
            position: absolute;
            bottom: 30mm;
            right: 25mm;
            width: 80px;
            height: 80px;
            border: 3px solid #e53935;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #e53935;
            font-size: 10pt;
            text-align: center;
            transform: rotate(-15deg);
        }
        
        /* 각주 */
        .footer-note {
            position: absolute;
            bottom: 15mm;
            left: 20mm;
            right: 20mm;
            padding-top: 10px;
            border-top: 1px solid #e0e0e0;
            font-size: 8pt;
            color: #666;
            text-align: center;
        }
        
        /* 인쇄 시 스타일 */
        @media print {
            body {
                background: white;
            }
            .page {
                margin: 0;
                box-shadow: none;
                page-break-after: always;
            }
        }
        
        /* 통계 그래프 스타일 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 24pt;
            font-weight: 700;
            color: #3f51b5;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 10pt;
            color: #666;
        }
        
        .stat-change {
            font-size: 9pt;
            margin-top: 5px;
        }
        
        .stat-up {
            color: #4caf50;
        }
        
        .stat-down {
            color: #f44336;
        }
    </style>
</head>
<body>
    <!-- 페이지 1: 표지 및 기본 정보 -->
    <div class="page">
        <!-- 공식 문서 헤더 -->
        <div class="official-header">
            <div class="header-top">
                <div class="institution-info">
                    <div class="institution-name">{{institution_name}}</div>
                    <div class="institution-details">
                        {{institution_address}}<br>
                        Tel: {{institution_phone}} | Email: {{institution_email}}
                    </div>
                </div>
                <div class="document-info">
                    <div class="document-number">문서번호: {{document_number}}</div>
                    <div class="document-date">발행일: {{issue_date}}</div>
                </div>
            </div>
        </div>
        
        <!-- 보고서 제목 -->
        <div class="report-title">
            <h1>종합 학업 성적 분석 보고서</h1>
            <div class="report-subtitle">Comprehensive Academic Performance Analysis Report</div>
            <div class="report-subtitle-en">Báo cáo Phân tích Thành tích Học tập Tổng hợp</div>
        </div>
        
        <!-- 학생 프로필 카드 -->
        <div class="student-profile-card">
            <div class="profile-header">
                <div class="profile-photo">
                    {{#if student_photo}}
                        <img src="{{student_photo}}" style="width: 100%; height: 100%; object-fit: cover;">
                    {{else}}
                        사진
                    {{/if}}
                </div>
                <div class="profile-details">
                    <table>
                        <tr>
                            <td class="profile-label">성명 (한국어)</td>
                            <td class="profile-value">{{student_name_ko}}</td>
                            <td class="profile-label">학생 번호</td>
                            <td class="profile-value">{{student_code}}</td>
                        </tr>
                        <tr>
                            <td class="profile-label">성명 (베트남어)</td>
                            <td class="profile-value">{{student_name_vi}}</td>
                            <td class="profile-label">생년월일</td>
                            <td class="profile-value">{{birth_date}}</td>
                        </tr>
                        <tr>
                            <td class="profile-label">소속 유학원</td>
                            <td class="profile-value">{{agency_name}}</td>
                            <td class="profile-label">등록일</td>
                            <td class="profile-value">{{enrollment_date}}</td>
                        </tr>
                        <tr>
                            <td class="profile-label">희망 대학</td>
                            <td class="profile-value">{{target_university}}</td>
                            <td class="profile-label">희망 전공</td>
                            <td class="profile-value">{{target_major}}</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- 학업 성취도 요약 -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">📊</span>
                학업 성취도 요약
            </div>
            <div class="section-content">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">총 학습 기간</div>
                        <div class="stat-value">{{study_duration}}</div>
                        <div class="stat-label">개월</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">평균 출석률</div>
                        <div class="stat-value">{{average_attendance}}%</div>
                        <div class="stat-change stat-up">▲ {{attendance_change}}%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">TOPIK 최고 등급</div>
                        <div class="stat-value">{{topik_highest_level}}</div>
                        <div class="stat-label">급</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">상담 횟수</div>
                        <div class="stat-value">{{total_consultations}}</div>
                        <div class="stat-label">회</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- TOPIK 성적 상세 -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">📝</span>
                한국어능력시험(TOPIK) 성적
            </div>
            <div class="section-content">
                <div class="topik-results-card">
                    <div class="topik-header">
                        <div class="topik-title">TOPIK {{topik_type}} - {{topik_test_number}}회차</div>
                        <div class="topik-test-info">응시일: {{topik_test_date}} | 장소: {{topik_test_location}}</div>
                    </div>
                    <div class="topik-scores">
                        <div class="score-box">
                            <div class="score-label">듣기 (Listening)</div>
                            <div class="score-value">{{topik_listening}}</div>
                            <div class="score-max">/ 100</div>
                        </div>
                        <div class="score-box">
                            <div class="score-label">읽기 (Reading)</div>
                            <div class="score-value">{{topik_reading}}</div>
                            <div class="score-max">/ 100</div>
                        </div>
                        <div class="score-box">
                            <div class="score-label">쓰기 (Writing)</div>
                            <div class="score-value">{{topik_writing}}</div>
                            <div class="score-max">/ 100</div>
                        </div>
                    </div>
                    <div class="topik-total">
                        <div class="topik-total-label">총점 (Total Score)</div>
                        <div class="topik-total-score">{{topik_total}} / {{topik_max_score}}</div>
                        <div class="topik-level">{{topik_level}}급 합격</div>
                    </div>
                </div>
                
                <!-- TOPIK 성적 추이 -->
                <table class="achievement-table">
                    <thead>
                        <tr>
                            <th>시험 회차</th>
                            <th>응시일</th>
                            <th>듣기</th>
                            <th>읽기</th>
                            <th>쓰기</th>
                            <th>총점</th>
                            <th>등급</th>
                            <th>변화</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{topik_history}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- 페이지 2: 학습 진도 및 상담 이력 -->
    <div class="page">
        <!-- 학습 진도 분석 -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">📈</span>
                학습 진도 및 참여도 분석
            </div>
            <div class="section-content">
                <div class="progress-section">
                    <div class="progress-item">
                        <div class="progress-header">
                            <span class="progress-label">출석률 (Attendance Rate)</span>
                            <span class="progress-value">{{attendance_rate}}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: {{attendance_rate}}%">
                                {{attendance_status}}
                            </div>
                        </div>
                    </div>
                    
                    <div class="progress-item">
                        <div class="progress-header">
                            <span class="progress-label">과제 완성도 (Homework Completion)</span>
                            <span class="progress-value">{{homework_rate}}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: {{homework_rate}}%">
                                {{homework_status}}
                            </div>
                        </div>
                    </div>
                    
                    <div class="progress-item">
                        <div class="progress-header">
                            <span class="progress-label">수업 참여도 (Class Participation)</span>
                            <span class="progress-value">{{participation_rate}}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: {{participation_rate}}%">
                                {{participation_grade}}
                            </div>
                        </div>
                    </div>
                    
                    <div class="progress-item">
                        <div class="progress-header">
                            <span class="progress-label">학습 목표 달성도 (Goal Achievement)</span>
                            <span class="progress-value">{{goal_achievement}}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: {{goal_achievement}}%">
                                {{goal_status}}
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 월별 학습 통계 -->
                <table class="achievement-table">
                    <thead>
                        <tr>
                            <th>월</th>
                            <th>출석률</th>
                            <th>과제 완성도</th>
                            <th>수업 참여도</th>
                            <th>종합 평가</th>
                            <th>비고</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{monthly_stats}}
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- 상담 이력 및 발전 과정 -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">💬</span>
                상담 이력 및 발전 과정
            </div>
            <div class="section-content">
                <div class="timeline">
                    {{consultation_timeline}}
                </div>
            </div>
        </div>
        
        <!-- 희망 진로 변화 추이 -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">🎯</span>
                희망 진로 변화 추이
            </div>
            <div class="section-content">
                <table class="achievement-table">
                    <thead>
                        <tr>
                            <th>날짜</th>
                            <th>희망 대학</th>
                            <th>희망 전공</th>
                            <th>변경 사유</th>
                            <th>상담사 의견</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{university_change_history}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- 페이지 3: 종합 평가 및 추천사 -->
    <div class="page">
        <!-- 담당 교사 종합 평가 -->
        <div class="evaluation-section">
            <div class="evaluation-title">담당 교사 종합 평가</div>
            <div class="evaluation-content">
                <p>{{teacher_evaluation}}</p>
                <p style="margin-top: 15px;">
                    본 학생은 <span class="highlight-text">{{highlight_point_1}}</span>하며,
                    특히 <span class="highlight-text">{{highlight_point_2}}</span>한 점이 돋보입니다.
                    <span class="highlight-text">{{highlight_point_3}}</span>하여
                    한국 대학 진학에 충분한 준비가 되어 있다고 판단됩니다.
                </p>
            </div>
        </div>
        
        <!-- 기관장 추천사 -->
        <div class="evaluation-section">
            <div class="evaluation-title">기관장 추천사</div>
            <div class="evaluation-content">
                <p>{{director_recommendation}}</p>
                <p style="margin-top: 15px;">
                    본 기관은 해당 학생이 <span class="highlight-text">한국 유학에 필요한 모든 준비를 완료</span>하였으며,
                    <span class="highlight-text">성공적인 학업 수행이 가능</span>할 것임을 확신합니다.
                    따라서 귀 기관의 긍정적인 검토를 부탁드립니다.
                </p>
            </div>
        </div>
        
        <!-- 추가 특기사항 -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">⭐</span>
                특기사항 및 수상 경력
            </div>
            <div class="section-content">
                {{special_achievements}}
            </div>
        </div>
        
        <!-- 제출 서류 체크리스트 -->
        <div class="section">
            <div class="section-header">
                <span class="section-icon">📋</span>
                제출 서류 확인
            </div>
            <div class="section-content">
                <table class="achievement-table">
                    <thead>
                        <tr>
                            <th>서류명</th>
                            <th>제출 여부</th>
                            <th>발급일</th>
                            <th>유효기간</th>
                            <th>비고</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>TOPIK 성적표</td>
                            <td>✅ 제출 완료</td>
                            <td>{{topik_issue_date}}</td>
                            <td>{{topik_validity}}</td>
                            <td>원본 제출</td>
                        </tr>
                        <tr>
                            <td>출석 증명서</td>
                            <td>✅ 제출 완료</td>
                            <td>{{attendance_cert_date}}</td>
                            <td>발급일로부터 3개월</td>
                            <td>기관장 직인</td>
                        </tr>
                        <tr>
                            <td>성적 증명서</td>
                            <td>✅ 제출 완료</td>
                            <td>{{transcript_date}}</td>
                            <td>발급일로부터 3개월</td>
                            <td>봉인 처리</td>
                        </tr>
                        {{additional_documents}}
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- 서명 섹션 -->
        <div class="signature-section">
            <div class="signature-grid">
                <div class="signature-box">
                    <div class="signature-line"></div>
                    <div class="signature-name">{{student_name_ko}}</div>
                    <div class="signature-title">학생</div>
                </div>
                <div class="signature-box">
                    <div class="signature-line"></div>
                    <div class="signature-name">{{teacher_name}}</div>
                    <div class="signature-title">담당 교사</div>
                </div>
                <div class="signature-box">
                    <div class="signature-line"></div>
                    <div class="signature-name">{{director_name}}</div>
                    <div class="signature-title">기관장</div>
                </div>
            </div>
        </div>
        
        <!-- 공식 직인 -->
        <div class="official-stamp">
            기관<br>직인
        </div>
        
        <!-- 각주 -->
        <div class="footer-note">
            본 보고서는 {{institution_name}}에서 발행한 공식 문서이며, 무단 복제 및 위조 시 법적 책임을 물을 수 있습니다.<br>
            문의: {{institution_phone}} | {{institution_email}}
        </div>
    </div>
</body>
</html>